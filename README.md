TODO:
- [] Document the code;
- [] Update some variables
